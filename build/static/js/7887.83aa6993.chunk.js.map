{"version":3,"file":"static/js/7887.83aa6993.chunk.js","mappings":"6KAGO,MAAMA,EAAiBA,KAC5B,MAAMC,GAAWC,EAAAA,EAAAA,MACXC,GAAWC,EAAAA,EAAAA,MAEXC,EAAcC,IAAAA,MAASH,EAASI,OAAQ,CAAEC,mBAAmB,IAgCnE,MAAO,CACLC,OAAQJ,EACRK,IA/BUA,CAACC,EAAMC,IACjBX,EAAS,CAAEM,OAAQD,IAAAA,UAAa,IAAKD,EAAa,CAACM,GAAOC,MA+B1DC,MA3BaF,IACb,MAAMG,EAAY,IAAKT,GACnBS,EAAUH,WACLG,EAAUH,GAGnBV,EAAS,CAAEM,OAAQD,IAAAA,UAAa,IAAKQ,OAsBrCC,MA/BYA,IAAMd,EAAS,CAAEM,OAAQD,IAAAA,UAAa,MAgClDU,MA/BaP,GACbR,EAAS,CAAEM,OAAQD,IAAAA,UAAa,IAAKD,KAAgBI,MA+BrDQ,IApCWN,GAASN,EAAYM,GAqChCO,YAtBmBC,IACnB,MAAML,EAAY,IAAKT,KAAgBc,GACvClB,EAAS,CAAEM,OAAQD,IAAAA,UAAaQ,MAqBhCM,cAlBqBD,IACrB,MAAML,EAAY,IAAKT,GACvBc,EAAOE,SAASC,IACVR,EAAUQ,WACLR,EAAUQ,MAGrBrB,EAAS,CAAEM,OAAQD,IAAAA,UAAaQ,S,6QCnBpC,MAAM,KAAES,GAASC,EAAAA,EAsLjB,EApLqBC,KAAO,IAADC,EACzB,MAAM,EAAEC,IAAMC,EAAAA,EAAAA,MACR,KAAEC,IAASC,EAAAA,EAAAA,MACXzB,GAAcL,EAAAA,EAAAA,KACd+B,GAAWC,EAAAA,EAAAA,OAEX,WAAEC,IAAeC,EAAAA,EAAAA,KAAaC,GAAUA,EAAMC,MAAMC,EAAAA,KACpD,UAAEC,IAAcJ,EAAAA,EAAAA,KAAaC,GAAUA,EAAMI,UAAUF,EAAAA,KAEtDG,EAASC,IAAcC,EAAAA,EAAAA,UAAST,EAAWU,SAE5CC,EAAUC,QAAyB,QAAlBnB,EAAArB,EAAYI,cAAM,IAAAiB,OAAA,EAAlBA,EAAoBoB,OAAQ,IAEnDC,EAAAA,EAAAA,YAAU,KACRC,EAAanB,KAEZ,KAEHoB,EAAAA,EAAAA,IAAa,KACPhB,EAAWU,SACbK,EAAanB,KAGd,CAACI,EAAWU,UAEf,MAAMO,EAAOA,KACX,MAAMJ,EAAOF,EAAU,EACvBvC,EAAYK,IAAI,OAAQoC,IAEpBK,EAAOA,KACX,MAAML,EAAOF,EAAU,EACvBvC,EAAYK,IAAI,OAAQoC,IAUpBM,EAAsBC,IAAU,IAADC,EACnC,OAAKD,EACE,CACLE,MAAW,OAAJF,QAAI,IAAJA,GAAAA,EAAMG,YAAkB,OAAJH,QAAI,IAAJA,GAAiB,QAAbC,EAAJD,EAAMG,mBAAW,IAAAF,OAAb,EAAJA,EAAmBG,MAAY,OAAJJ,QAAI,IAAJA,OAAI,EAAJA,EAAMI,MAC5D7C,MAAW,OAAJyC,QAAI,IAAJA,OAAI,EAAJA,EAAMK,IAHG,MAOdV,EAAgBnB,IACpBY,GAAW,GACXkB,EAAAA,EAAAA,QACW9B,GACR+B,MAAMC,IAAS,IAADC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EACb,MAAMC,EAAS,GACZ,OAAHZ,QAAG,IAAHA,GAAS,QAANC,EAAHD,EAAKa,YAAI,IAAAZ,GAAQ,QAARC,EAATD,EAAWa,cAAM,IAAAZ,GAAjBA,EAAmB1C,SAASuD,IAAW,IAADC,EAC/B,OAALD,QAAK,IAALA,GAAa,QAARC,EAALD,EAAOH,cAAM,IAAAI,GAAbA,EAAexD,SAASyD,IACgB,IAADC,EAAAC,EAKjCC,EAAAC,EAOGC,GAZE,OAALL,QAAK,IAALA,OAAK,EAALA,EAAOM,kBAAkBX,EAElB,OAANA,QAAM,IAANA,GAA+B,QAAzBM,EAANN,EAAc,OAALK,QAAK,IAALA,OAAK,EAALA,EAAOM,uBAAe,IAAAL,GAAQ,QAARC,EAA/BD,EAAiCtE,cAAM,IAAAuE,GAAvCA,EAAyCK,MACvChC,IAAa,OAAJA,QAAI,IAAJA,OAAI,EAAJA,EAAMzC,UAAe,OAALkE,QAAK,IAALA,OAAK,EAALA,EAAOpB,OAG7B,OAANe,QAAM,IAANA,GAA+B,QAAzBQ,EAANR,EAAc,OAALK,QAAK,IAALA,OAAK,EAALA,EAAOM,uBAAe,IAAAH,GAAQ,QAARC,EAA/BD,EAAiCxE,cAAM,IAAAyE,GAAvCA,EAAyCI,KAAK,CAC5C1E,MAAY,OAALkE,QAAK,IAALA,OAAK,EAALA,EAAOpB,GACdH,MAAY,OAALuB,QAAK,IAALA,OAAK,EAALA,EAAOlE,MACd2E,SAAe,OAALX,QAAK,IAALA,OAAK,EAALA,EAAOlB,KAIrBe,EAAY,OAALK,QAAK,IAALA,OAAK,EAALA,EAAOM,gBAAkB,CAC9B7B,MAAY,OAALuB,QAAK,IAALA,GAAwB,QAAnBK,EAALL,EAAOU,MAAMhC,mBAAW,IAAA2B,OAAnB,EAALA,EAA0B1B,MACjC7C,MAAY,OAALkE,QAAK,IAALA,OAAK,EAALA,EAAOM,eACd1B,GAAS,OAALoB,QAAK,IAALA,OAAK,EAALA,EAAOM,eACXG,SAAe,OAALX,QAAK,IAALA,OAAK,EAALA,EAAOlB,GACjBjD,OAAQ,CACN,CACEG,MAAY,OAALkE,QAAK,IAALA,OAAK,EAALA,EAAOpB,GACdH,MAAY,OAALuB,QAAK,IAALA,OAAK,EAALA,EAAOlE,MACd2E,SAAe,OAALX,QAAK,IAALA,OAAK,EAALA,EAAOlB,YAO7B,MAAMgB,EAAO,IACRb,EAAIa,QACJe,EAAqB,OAAH5B,QAAG,IAAHA,OAAG,EAAHA,EAAKa,MAC1BgB,KAAMtC,EAAsB,OAAHS,QAAG,IAAHA,GAAS,QAANG,EAAHH,EAAKa,YAAI,IAAAV,OAAN,EAAHA,EAAW0B,MACpCC,SAAUvC,EAAsB,OAAHS,QAAG,IAAHA,GAAS,QAANI,EAAHJ,EAAKa,YAAI,IAAAT,OAAN,EAAHA,EAAW0B,UACxCC,MAAOxC,EAAsB,OAAHS,QAAG,IAAHA,GAAS,QAANK,EAAHL,EAAKa,YAAI,IAAAR,OAAN,EAAHA,EAAW0B,OACrCC,QAASzC,EAAsB,OAAHS,QAAG,IAAHA,GAAS,QAANM,EAAHN,EAAKa,YAAI,IAAAP,OAAN,EAAHA,EAAW0B,SACvCC,KAAM1C,EAAsB,OAAHS,QAAG,IAAHA,GAAS,QAANO,EAAHP,EAAKa,YAAI,IAAAN,OAAN,EAAHA,EAAW0B,MACpCC,QA5DcC,EA4DU,OAAHnC,QAAG,IAAHA,GAAS,QAANQ,EAAHR,EAAKa,YAAI,IAAAL,OAAN,EAAHA,EAAW4B,UA3DtCD,EAAME,KAAK7C,IAAI,CACb8C,IAAS,OAAJ9C,QAAI,IAAJA,OAAI,EAAJA,EAAMK,GACX/C,KAAU,OAAJ0C,QAAI,IAAJA,OAAI,EAAJA,EAAM+C,KACZC,IAAS,OAAJhD,QAAI,IAAJA,OAAI,EAAJA,EAAM+C,UAyDP3B,OAAQ6B,OAAO7F,OAAOgE,GACtBE,OAAW,OAAHd,QAAG,IAAHA,GAAS,QAANS,EAAHT,EAAKa,YAAI,IAAAJ,GAAQ,QAARC,EAATD,EAAWK,cAAM,IAAAJ,OAAd,EAAHA,EAAmB2B,KAAKtB,IAAK,IAAA2B,EAAA,MAAM,IACtC3B,KACA0B,OAAOE,OACR,MACQ,OAAL5B,QAAK,IAALA,GAAa,QAAR2B,EAAL3B,EAAOH,cAAM,IAAA8B,OAAR,EAALA,EAAeL,KAAI,CAACpB,EAAO2B,KAAG,CAC/B,CAAC,UAAUA,MAAS3B,EAAMpB,QAG9BgD,UAAe,OAAL9B,QAAK,IAALA,OAAK,EAALA,EAAO8B,WAAY,EAC7BC,OAAY,OAAL/B,QAAK,IAALA,OAAK,EAALA,EAAO+B,QAAS,EACvBlC,YAAQmC,MAEVC,WAAe,OAAHhD,QAAG,IAAHA,GAAS,QAANW,EAAHX,EAAKa,YAAI,IAAAF,OAAN,EAAHA,EAAWqC,WACvBrD,iBAAaoD,EACbE,kBAAcF,GA5EAZ,IAAAA,EA8EhBjE,GAASgF,EAAAA,EAAAA,IAAY,CAAE9E,WAAAA,EAAYyC,KAAAA,QAEpCsC,SAAQ,KACPvE,GAAW,GACXV,GAASkF,EAAAA,EAAAA,IAAehF,QAIxBwD,EAAqBf,IACzB,GAAS,OAAJA,QAAI,IAAJA,IAAAA,EAAMoC,aACT,MAAO,GAET,MAAM,aAAEA,GAAiBpC,EACnBwC,EAAkB,OAAT5E,QAAS,IAATA,OAAS,EAATA,EAAW4D,KAAK7C,IAAI,IAAA8D,EAAAC,EAAA,MAAM,CACvC,CAAC,SAAa,OAAJ/D,QAAI,IAAJA,OAAI,EAAJA,EAAMgE,WAAwB,OAAZP,QAAY,IAAZA,GAE3B,QAFuCK,EAAZL,EAAcQ,MACvCC,IAAS,OAAFA,QAAE,IAAFA,OAAE,EAAFA,EAAIF,WAAe,OAAJhE,QAAI,IAAJA,OAAI,EAAJA,EAAMgE,iBAC9B,IAAAF,OAFuC,EAAZA,EAEzB1D,MACH,CAAC,eAAmB,OAAJJ,QAAI,IAAJA,OAAI,EAAJA,EAAMgE,WAAwB,OAAZP,QAAY,IAAZA,GAEjC,QAF6CM,EAAZN,EAAcQ,MAC7CC,IAAS,OAAFA,QAAE,IAAFA,OAAE,EAAFA,EAAIF,WAAe,OAAJhE,QAAI,IAAJA,OAAI,EAAJA,EAAMgE,iBAC9B,IAAAD,OAF6C,EAAZA,EAE/BI,gBAEL,OAAOlB,OAAOE,OAAO,MAAOU,IAQ9B,OACEO,EAAAA,EAAAA,MAAAC,EAAAA,SAAA,CAAAC,SAAA,EACEC,EAAAA,EAAAA,KAACC,EAAAA,EAAI,CAACpE,MAAO9B,EAAE,gBAAiBmD,OAAO8C,EAAAA,EAAAA,KAACE,EAAAA,EAAY,IAAIH,UACtDC,EAAAA,EAAAA,KAACpG,EAAAA,EAAK,CAACoB,QAASA,EAASmF,SARbjF,IAChBf,GAASgF,EAAAA,EAAAA,IAAY,CAAE9E,WAAAA,EAAYyC,KAAM,IAAKzC,EAAWyC,KAAM5B,KAAAA,MAC/DzC,EAAYK,IAAI,OAAQoC,IAMwB6E,SACzCK,EAAAA,EAAAA,KAAW3E,IACVuE,EAAAA,EAAAA,KAACrG,EAAI,CAACkC,MAAO9B,EAAE0B,EAAKI,QAAaJ,EAAKI,aAI1CjB,GAuBAoF,EAAAA,EAAAA,KAAA,OAAKK,UAAU,mDAAkDN,UAC/DC,EAAAA,EAAAA,KAACM,EAAAA,EAAI,CAACC,KAAK,QAAQF,UAAU,YAvB/BR,EAAAA,EAAAA,MAAA,OAAAE,SAAA,CAC8B,kBAA3BK,EAAAA,EAAMpF,GAASwF,UACdR,EAAAA,EAAAA,KAACS,EAAAA,EAAa,CAACnF,KAAMA,EAAMoF,YAAa,SAGd,mBAA3BN,EAAAA,EAAMpF,GAASwF,UACdR,EAAAA,EAAAA,KAACW,EAAAA,EAAa,CAACrF,KAAMA,EAAMC,KAAMA,IAGP,kBAA3B6E,EAAAA,EAAMpF,GAASwF,UACdR,EAAAA,EAAAA,KAACY,EAAAA,EAAY,CAACtF,KAAMA,EAAMC,KAAMA,IAGN,mBAA3B6E,EAAAA,EAAMpF,GAASwF,UACdR,EAAAA,EAAAA,KAACa,EAAAA,EAAe,CAACvF,KAAMA,EAAMC,KAAMA,IAGT,mBAA3B6E,EAAAA,EAAMpF,GAASwF,UACdR,EAAAA,EAAAA,KAACc,EAAAA,EAAa,CAACvF,KAAMA,Y","sources":["helpers/useQueryParams.js","views/products/product-edit.js"],"sourcesContent":["import { useNavigate, useLocation } from 'react-router-dom';\nimport qs from 'qs';\n\nexport const useQueryParams = () => {\n  const navigate = useNavigate();\n  const location = useLocation();\n\n  const queryParams = qs.parse(location.search, { ignoreQueryPrefix: true });\n\n  const get = (name) => queryParams[name];\n  const set = (name, value) =>\n    navigate({ search: qs.stringify({ ...queryParams, [name]: value }) });\n  const clear = () => navigate({ search: qs.stringify({}) });\n  const merge = (values) =>\n    navigate({ search: qs.stringify({ ...queryParams, ...values }) });\n  const reset = (name) => {\n    const newParams = { ...queryParams };\n    if (newParams[name]) {\n      delete newParams[name];\n    }\n\n    navigate({ search: qs.stringify({ ...newParams }) });\n  };\n\n  const setMultiple = (params) => {\n    const newParams = { ...queryParams, ...params };\n    navigate({ search: qs.stringify(newParams) });\n  };\n\n  const resetMultiple = (params) => {\n    const newParams = { ...queryParams };\n    params.forEach((param) => {\n      if (newParams[param]) {\n        delete newParams[param];\n      }\n    });\n    navigate({ search: qs.stringify(newParams) });\n  };\n\n  return {\n    values: queryParams,\n    set,\n    reset,\n    clear,\n    merge,\n    get,\n    setMultiple,\n    resetMultiple,\n  };\n};\n","import React, { useEffect, useState } from 'react';\nimport { Card, Spin, Steps } from 'antd';\nimport LanguageList from 'components/language-list';\nimport { useParams } from 'react-router-dom';\nimport productService from 'services/product';\nimport { shallowEqual, useDispatch, useSelector } from 'react-redux';\nimport { disableRefetch, setMenuData } from 'redux/slices/menu';\nimport { useTranslation } from 'react-i18next';\nimport { useQueryParams } from 'helpers/useQueryParams';\nimport useDidUpdate from 'helpers/useDidUpdate';\nimport ProductStock from 'components/forms/product/stock';\nimport { steps } from './steps';\nimport ProductProperty from './property';\nimport ProductFinish from './product-finish';\nimport ProductExtras from './product-extras';\nimport ProductsIndex from './products-index';\n\nconst { Step } = Steps;\n\nconst ProductsEdit = () => {\n  const { t } = useTranslation();\n  const { uuid } = useParams();\n  const queryParams = useQueryParams();\n  const dispatch = useDispatch();\n\n  const { activeMenu } = useSelector((state) => state.menu, shallowEqual);\n  const { languages } = useSelector((state) => state.formLang, shallowEqual);\n\n  const [loading, setLoading] = useState(activeMenu.refetch);\n\n  const current = Number(queryParams.values?.step || 0);\n\n  useEffect(() => {\n    fetchProduct(uuid);\n    // eslint-disable-next-line\n  }, []);\n\n  useDidUpdate(() => {\n    if (activeMenu.refetch) {\n      fetchProduct(uuid);\n    }\n    // eslint-disable-next-line\n  }, [activeMenu.refetch]);\n\n  const next = () => {\n    const step = current + 1;\n    queryParams.set('step', step);\n  };\n  const prev = () => {\n    const step = current - 1;\n    queryParams.set('step', step);\n  };\n\n  const createImages = (items) =>\n    items.map((item) => ({\n      uid: item?.id,\n      name: item?.path,\n      url: item?.path,\n    }));\n\n  const createSelectObject = (item) => {\n    if (!item) return null;\n    return {\n      label: item?.translation ? item?.translation?.title : item?.title,\n      value: item?.id,\n    };\n  };\n\n  const fetchProduct = (uuid) => {\n    setLoading(true);\n    productService\n      .getById(uuid)\n      .then((res) => {\n        const extras = {};\n        res?.data?.stocks?.forEach((stock) => {\n          stock?.extras?.forEach((extra) => {\n            if (extra?.extra_group_id in extras) {\n              if (\n                !extras?.[extra?.extra_group_id]?.values?.some(\n                  (item) => item?.value === extra?.id,\n                )\n              ) {\n                extras?.[extra?.extra_group_id]?.values?.push({\n                  value: extra?.id,\n                  label: extra?.value,\n                  stock_id: stock?.id,\n                });\n              }\n            } else {\n              extras[extra?.extra_group_id] = {\n                label: extra?.group.translation?.title,\n                value: extra?.extra_group_id,\n                id: extra?.extra_group_id,\n                stock_id: stock?.id,\n                values: [\n                  {\n                    value: extra?.id,\n                    label: extra?.value,\n                    stock_id: stock?.id,\n                  },\n                ],\n              };\n            }\n          });\n        });\n        const data = {\n          ...res.data,\n          ...getLanguageFields(res?.data),\n          shop: createSelectObject(res?.data?.shop),\n          category: createSelectObject(res?.data?.category),\n          brand: createSelectObject(res?.data?.brand),\n          kitchen: createSelectObject(res?.data?.kitchen),\n          unit: createSelectObject(res?.data?.unit),\n          images: createImages(res?.data?.galleries),\n          extras: Object.values(extras),\n          stocks: res?.data?.stocks?.map((stock) => ({\n            ...stock,\n            ...Object.assign(\n              {},\n              ...stock?.extras?.map((extra, idx) => ({\n                [`extras[${idx}]`]: extra.id,\n              })),\n            ),\n            quantity: stock?.quantity || 0,\n            price: stock?.price || 0,\n            extras: undefined,\n          })),\n          properties: res?.data?.properties,\n          translation: undefined,\n          translations: undefined,\n        };\n        dispatch(setMenuData({ activeMenu, data }));\n      })\n      .finally(() => {\n        setLoading(false);\n        dispatch(disableRefetch(activeMenu));\n      });\n  };\n\n  const getLanguageFields = (data) => {\n    if (!data?.translations) {\n      return {};\n    }\n    const { translations } = data;\n    const result = languages?.map((item) => ({\n      [`title[${item?.locale}]`]: translations?.find(\n        (el) => el?.locale === item?.locale,\n      )?.title,\n      [`description[${item?.locale}]`]: translations?.find(\n        (el) => el?.locale === item?.locale,\n      )?.description,\n    }));\n    return Object.assign({}, ...result);\n  };\n\n  const onChange = (step) => {\n    dispatch(setMenuData({ activeMenu, data: { ...activeMenu.data, step } }));\n    queryParams.set('step', step);\n  };\n\n  return (\n    <>\n      <Card title={t('edit.product')} extra={<LanguageList />}>\n        <Steps current={current} onChange={onChange}>\n          {steps.map((item) => (\n            <Step title={t(item.title)} key={item.title} />\n          ))}\n        </Steps>\n      </Card>\n      {!loading ? (\n        <div>\n          {steps[current].content === 'First-content' && (\n            <ProductsIndex next={next} action_type={'edit'} />\n          )}\n\n          {steps[current].content === 'Second-content' && (\n            <ProductExtras next={next} prev={prev} />\n          )}\n\n          {steps[current].content === 'Third-content' && (\n            <ProductStock next={next} prev={prev} />\n          )}\n\n          {steps[current].content === 'Fourth-content' && (\n            <ProductProperty next={next} prev={prev} />\n          )}\n\n          {steps[current].content === 'Finish-content' && (\n            <ProductFinish prev={prev} />\n          )}\n        </div>\n      ) : (\n        <div className='d-flex justify-content-center align-items-center'>\n          <Spin size='large' className='py-5' />\n        </div>\n      )}\n    </>\n  );\n};\nexport default ProductsEdit;\n"],"names":["useQueryParams","navigate","useNavigate","location","useLocation","queryParams","qs","search","ignoreQueryPrefix","values","set","name","value","reset","newParams","clear","merge","get","setMultiple","params","resetMultiple","forEach","param","Step","Steps","ProductsEdit","_queryParams$values","t","useTranslation","uuid","useParams","dispatch","useDispatch","activeMenu","useSelector","state","menu","shallowEqual","languages","formLang","loading","setLoading","useState","refetch","current","Number","step","useEffect","fetchProduct","useDidUpdate","next","prev","createSelectObject","item","_item$translation","label","translation","title","id","productService","then","res","_res$data","_res$data$stocks","_res$data2","_res$data3","_res$data4","_res$data5","_res$data6","_res$data7","_res$data8","_res$data8$stocks","_res$data9","extras","data","stocks","stock","_stock$extras","extra","_extras$extra$extra_g","_extras$extra$extra_g2","_extras$extra$extra_g3","_extras$extra$extra_g4","_extra$group$translat","extra_group_id","some","push","stock_id","group","getLanguageFields","shop","category","brand","kitchen","unit","images","items","galleries","map","uid","path","url","Object","_stock$extras2","assign","idx","quantity","price","undefined","properties","translations","setMenuData","finally","disableRefetch","result","_translations$find","_translations$find2","locale","find","el","description","_jsxs","_Fragment","children","_jsx","Card","LanguageList","onChange","steps","className","Spin","size","content","ProductsIndex","action_type","ProductExtras","ProductStock","ProductProperty","ProductFinish"],"sourceRoot":""}