{"version":3,"file":"static/js/9431.f43ad488.chunk.js","mappings":"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","sources":["helpers/formatSortType.js","views/backup/index.js","../node_modules/@ant-design/icons-svg/es/asn/CloudDownloadOutlined.js","../node_modules/@ant-design/icons/es/icons/CloudDownloadOutlined.js"],"sourcesContent":["export default function formatSortType(type) {\n  switch (type) {\n    case 'ascend':\n      return 'asc';\n\n    case 'descend':\n      return 'desc';\n\n    default:\n      break;\n  }\n}\n","import React, { useEffect, useState } from 'react';\nimport { Card, Button, Table, Tooltip, Result } from 'antd';\nimport { BASE_URL, api_url } from '../../configs/app-global';\nimport { shallowEqual, useDispatch, useSelector } from 'react-redux';\nimport { useTranslation } from 'react-i18next';\nimport { CloudDownloadOutlined } from '@ant-design/icons';\nimport formatSortType from '../../helpers/formatSortType';\nimport { disableRefetch, setMenuData } from '../../redux/slices/menu';\nimport useDidUpdate from '../../helpers/useDidUpdate';\nimport { fetchBackups } from '../../redux/slices/backup';\nimport { toast } from 'react-toastify';\nimport axios from 'axios';\nimport useDemo from '../../helpers/useDemo';\nimport moment from \"moment/moment\";\n\nexport default function Backup() {\n  const [loadingBtn, setLoadingBtn] = useState(false);\n  const dispatch = useDispatch();\n  const { t } = useTranslation();\n  const access_token = localStorage.getItem('token');\n\n  const columns = [\n    {\n      title: t('id'),\n      dataIndex: 'id',\n      key: 'id',\n      sorter: true,\n    },\n    {\n      title: t('client'),\n      dataIndex: 'user',\n      key: 'user',\n      render: (user) => (\n        <div>\n          {user.firstname} {user.lastname}\n        </div>\n      ),\n    },\n    {\n      title: t('title'),\n      dataIndex: 'title',\n      key: 'title',\n    },\n    {\n      title: t('created.at'),\n      dataIndex: 'created_at',\n      key: 'created_at',\n      render: (_, row) => moment(row?.created_at).format('YYYY-MM-DD HH:mm')\n    },\n    {\n      title: t('options'),\n      dataIndex: 'title',\n      key: 'title',\n      render: (title) => (\n        <Tooltip title={t('download.backup')}>\n          <Button\n            type='primary'\n            icon={<CloudDownloadOutlined />}\n            onClick={() => downloadBackup('/storage/laravel-backup/' + title)}\n          />\n        </Tooltip>\n      ),\n    },\n  ];\n\n  const { activeMenu } = useSelector((state) => state.menu, shallowEqual);\n  const { history, meta, loading, params } = useSelector(\n    (state) => state.backup,\n    shallowEqual\n  );\n  const data = activeMenu.data;\n  const { isDemo } = useDemo();\n\n  function onChangePagination(pagination, filters, sorter) {\n    const { pageSize: perPage, current: page } = pagination;\n    const { field: column, order } = sorter;\n    const sort = formatSortType(order);\n    dispatch(\n      setMenuData({\n        activeMenu,\n        data: { perPage, page, column, sort },\n      })\n    );\n  }\n\n  useDidUpdate(() => {\n    if (isDemo) {\n      return;\n    }\n    const paramsData = {\n      sort: data?.sort,\n      column: data?.column,\n      perPage: data?.perPage,\n      page: data?.page,\n    };\n    dispatch(fetchBackups(paramsData));\n  }, [activeMenu.data]);\n\n  useEffect(() => {\n    if (activeMenu.refetch) {\n      if (isDemo) {\n        return;\n      }\n      dispatch(fetchBackups());\n      dispatch(disableRefetch(activeMenu));\n    }\n  }, [activeMenu.refetch]);\n\n  const getBackup = () => {\n    toast.warning(!isDemo ? t('backup.loading') : null);\n    if (isDemo) {\n      toast.warning(t('cannot.work.demo'));\n      return;\n    }\n    setLoadingBtn(true);\n    axios\n      .post(\n        `${api_url}dashboard/admin/backup/history`,\n        {},\n        {\n          headers: {\n            Authorization: `Bearer ${access_token}`,\n            'content-type': 'text/json',\n          },\n        }\n      )\n      .then((res) => downloadBackup(res.data.data.path))\n      .finally(() => setLoadingBtn(false));\n  };\n\n  function downloadBackup(path) {\n    const link = document.createElement('a');\n    link.href = BASE_URL + path;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  }\n\n  return (\n    <Card title={t('backup')}>\n      <Result\n        status='warning'\n        title={t('do.you.care.about.your.data')}\n        subTitle={t('here.you.can.take.backup.from.database')}\n        extra={\n          <Button type='primary' loading={loadingBtn} onClick={getBackup}>\n            {t('download.backup')}\n          </Button>\n        }\n      />\n      <Table\n        scroll={{ x: true }}\n        columns={columns}\n        dataSource={history}\n        loading={loading}\n        pagination={{\n          pageSize: params.perPage,\n          page: params.page,\n          total: meta.total,\n          defaultCurrent: params.page,\n        }}\n        rowKey={(record) => record.id}\n        onChange={onChangePagination}\n      />\n    </Card>\n  );\n}\n","// This icon file is generated automatically.\nvar CloudDownloadOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M624 706.3h-74.1V464c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v242.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.7a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9z\" } }, { \"tag\": \"path\", \"attrs\": { \"d\": \"M811.4 366.7C765.6 245.9 648.9 160 512.2 160S258.8 245.8 213 366.6C127.3 389.1 64 467.2 64 560c0 110.5 89.5 200 199.9 200H304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8h-40.1c-33.7 0-65.4-13.4-89-37.7-23.5-24.2-36-56.8-34.9-90.6.9-26.4 9.9-51.2 26.2-72.1 16.7-21.3 40.1-36.8 66.1-43.7l37.9-9.9 13.9-36.6c8.6-22.8 20.6-44.1 35.7-63.4a245.6 245.6 0 0152.4-49.9c41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.2c19.9 14 37.5 30.8 52.4 49.9 15.1 19.3 27.1 40.7 35.7 63.4l13.8 36.5 37.8 10C846.1 454.5 884 503.8 884 560c0 33.1-12.9 64.3-36.3 87.7a123.07 123.07 0 01-87.6 36.3H720c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h40.1C870.5 760 960 670.5 960 560c0-92.7-63.1-170.7-148.6-193.3z\" } }] }, \"name\": \"cloud-download\", \"theme\": \"outlined\" };\nexport default CloudDownloadOutlined;\n","import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport * as React from 'react';\nimport CloudDownloadOutlinedSvg from \"@ant-design/icons-svg/es/asn/CloudDownloadOutlined\";\nimport AntdIcon from '../components/AntdIcon';\n\nvar CloudDownloadOutlined = function CloudDownloadOutlined(props, ref) {\n  return /*#__PURE__*/React.createElement(AntdIcon, _objectSpread(_objectSpread({}, props), {}, {\n    ref: ref,\n    icon: CloudDownloadOutlinedSvg\n  }));\n};\n\nCloudDownloadOutlined.displayName = 'CloudDownloadOutlined';\nexport default /*#__PURE__*/React.forwardRef(CloudDownloadOutlined);"],"names":["formatSortType","type","Backup","loadingBtn","setLoadingBtn","useState","dispatch","useDispatch","t","useTranslation","access_token","localStorage","getItem","columns","title","dataIndex","key","sorter","render","user","_jsxs","children","firstname","lastname","_","row","moment","created_at","format","_jsx","Tooltip","Button","icon","CloudDownloadOutlined","onClick","downloadBackup","activeMenu","useSelector","state","menu","shallowEqual","history","meta","loading","params","backup","data","isDemo","useDemo","useDidUpdate","paramsData","sort","column","perPage","page","fetchBackups","useEffect","refetch","disableRefetch","path","link","document","createElement","href","BASE_URL","body","appendChild","click","removeChild","Card","Result","status","subTitle","extra","getBackup","toast","axios","api_url","headers","Authorization","then","res","finally","Table","scroll","x","dataSource","pagination","pageSize","total","defaultCurrent","rowKey","record","id","onChange","filters","current","field","order","setMenuData","props","ref","React","AntdIcon","_objectSpread","CloudDownloadOutlinedSvg","displayName"],"sourceRoot":""}