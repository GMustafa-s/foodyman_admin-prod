"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[49],{93669:(e,t,s)=>{s.d(t,{Z:()=>Y});var a=s(72791),l=s(77483),n=s(83099),i=s(87309),r=s(16871),d=s(66106),o=s(30914),c=s(54080),u=s(86005),m=s(25581),g=s(38243),h=s(91333),x=s(66818),Z=s(49355),p=s(28748),j=s(79337),v=s(33168),f=s(15764),y=s(58998),b=s(95568),_=s(85830),I=s(80184);function q(e){let{setLocation:t,form:s,item:a,idx:n,defaultLang:i}=e;const{t:r}=(0,v.$)(),{google_map_key:d}=(0,j.v9)((e=>e.globalSettings.settings),j.wU),{ref:o}=(0,b.usePlacesWidget)({apiKey:d||_.kr,onPlaceSelected:e=>{const a={lat:null===e||void 0===e?void 0:e.geometry.location.lat(),lng:null===e||void 0===e?void 0:e.geometry.location.lng()};t(a),s.setFieldsValue({[`address[${i}]`]:null===e||void 0===e?void 0:e.formatted_address})}});return(0,I.jsx)(l.Z.Item,{label:r("address"),name:`address[${null===a||void 0===a?void 0:a.locale}]`,rules:[{required:(null===a||void 0===a?void 0:a.locale)===i,message:r("required")}],hidden:(null===a||void 0===a?void 0:a.locale)!==i,children:(0,I.jsx)("input",{className:"address-input",ref:o,placeholder:""})},"address"+n)}var w=s(11918),k=s(68961),S=s(71550),F=s(72568),L=s(35740),N=s(24455);const $=e=>{let{logoImage:t,setLogoImage:s,backImage:n,setBackImage:r,form:b,location:_,setLocation:$,user:O}=e;const{t:H}=(0,v.$)(),[M,Y]=(0,a.useState)(null),[D,U]=(0,a.useState)(null),[A,B]=(0,a.useState)(null),{defaultLang:C,languages:V}=(0,j.v9)((e=>e.formLang),j.wU);const P=()=>{Y(!0),B(!0)},R=()=>{U(!0),B(!0)},T=()=>{Y(!1),U(!1)};return(0,I.jsxs)(d.Z,{gutter:12,children:[(0,I.jsx)(o.Z,{span:24,children:(0,I.jsx)(c.Z,{children:(0,I.jsxs)(d.Z,{gutter:12,children:[(0,I.jsx)(o.Z,{span:4,children:(0,I.jsx)(l.Z.Item,{label:H("logo.image"),children:(0,I.jsx)(w.Z,{type:"shops/logo",imageList:t,setImageList:s,form:b,multiple:!1,name:"logo_img"})})}),(0,I.jsx)(o.Z,{span:4,children:(0,I.jsx)(l.Z.Item,{label:H("background.image"),children:(0,I.jsx)(w.Z,{type:"shops/background",imageList:n,setImageList:r,form:b,multiple:!1,name:"background_img"})})}),(0,I.jsx)(o.Z,{span:10,children:(0,I.jsx)(l.Z.Item,{label:H("status.note"),name:"status_note",children:(0,I.jsx)(Z.Z,{rows:4})})}),(0,I.jsx)(o.Z,{span:4,children:(0,I.jsx)(l.Z.Item,{name:"status",label:H("status"),children:(0,I.jsx)(u.Z,{disabled:!0})})}),(0,I.jsx)(o.Z,{span:2,children:(0,I.jsx)(l.Z.Item,{label:H("open"),name:"open",valuePropName:"checked",children:(0,I.jsx)(m.Z,{disabled:!0})})})]})})}),(0,I.jsx)(o.Z,{span:24,children:(0,I.jsx)(c.Z,{title:H("general"),children:(0,I.jsxs)(d.Z,{gutter:12,children:[(0,I.jsx)(o.Z,{span:12,children:(0,I.jsxs)(d.Z,{gutter:12,children:[(0,I.jsx)(o.Z,{span:24,children:V.map(((e,t)=>(0,I.jsx)(l.Z.Item,{label:H("title"),name:`title[${e.locale}]`,rules:[{required:e.locale===C,message:H("required")},{min:2,message:H("title.required")}],hidden:e.locale!==C,children:(0,I.jsx)(u.Z,{})},"title"+t)))}),(0,I.jsx)(o.Z,{span:24,children:(0,I.jsx)(l.Z.Item,{label:H("phone"),name:"phone",rules:[{required:!0,message:H("required")}],children:(0,I.jsx)(g.Z,{min:0,className:"w-100"})})})]})}),(0,I.jsx)(o.Z,{span:12,children:V.map(((e,t)=>(0,I.jsx)(l.Z.Item,{label:H("description"),name:`description[${e.locale}]`,rules:[{required:e.locale===C,message:H("required")},{min:3,message:H("required")}],hidden:e.locale!==C,children:(0,I.jsx)(Z.Z,{rows:4})},"desc"+t)))}),(0,I.jsx)(o.Z,{span:8,children:(0,I.jsx)(l.Z.Item,{label:H("restaurant.tags"),name:"tags",rules:[{required:!1,message:H("required")}],children:(0,I.jsx)(L.R,{mode:"multiple",fetchOptions:async function(e){B(!1);const t={search:e};return N.Z.getAll(t).then((e=>{let{data:t}=e;return t.map((e=>{var t;return{label:(null===(t=e.translation)||void 0===t?void 0:t.title)||"no name",value:e.id}}))}))},refetch:A})})}),(0,I.jsx)(o.Z,{span:8,children:(0,I.jsx)(l.Z.Item,{label:H("seller"),name:"user",rules:[{required:!0,message:H("required")}],children:(0,I.jsx)(L.R,{disabled:O,fetchOptions:async function(e){const t={search:e,roles:"user","empty-shop":1};return B(!1),p.Z.search(t).then((e=>e.data.map((e=>({label:e.firstname+" "+(e.lastname?e.lastname:""),value:e.id})))))},refetch:A,dropdownRender:e=>(0,I.jsxs)(I.Fragment,{children:[e,(0,I.jsx)(h.Z,{style:{margin:"8px 0"}}),(0,I.jsx)(i.Z,{className:"w-100",disabled:O,icon:(0,I.jsx)(k.Z,{}),onClick:P,children:H("add.user")})]})})})}),(0,I.jsx)(o.Z,{span:8,children:(0,I.jsx)(l.Z.Item,{label:H("categories"),name:"categories",rules:[{required:!0,message:H("required")}],children:(0,I.jsx)(L.R,{mode:"multiple",fetchOptions:async function(e){const t={search:e,type:"shop"};return B(!1),f.Z.getAll(t).then((e=>{let{data:t}=e;return t.map((e=>{var t;return{label:(null===(t=e.translation)||void 0===t?void 0:t.title)||"no name",value:e.id}}))}))},refetch:A,dropdownRender:e=>(0,I.jsxs)(I.Fragment,{children:[e,(0,I.jsx)(h.Z,{style:{margin:"8px 0"}}),(0,I.jsx)(i.Z,{className:"w-100",icon:(0,I.jsx)(k.Z,{}),onClick:R,children:H("add.category")})]})})})})]})})}),(0,I.jsx)(o.Z,{span:8,children:(0,I.jsx)(c.Z,{title:H("delivery"),children:(0,I.jsxs)(d.Z,{gutter:8,children:[(0,I.jsx)(o.Z,{span:12,children:(0,I.jsx)(l.Z.Item,{name:"price",label:H("min.price"),rules:[{required:!0,message:H("required")}],children:(0,I.jsx)(g.Z,{className:"w-100"})})}),(0,I.jsx)(o.Z,{span:12,children:(0,I.jsx)(l.Z.Item,{name:"price_per_km",label:H("price.per.km"),rules:[{required:!0,message:H("required")}],children:(0,I.jsx)(g.Z,{className:"w-100"})})})]})})}),(0,I.jsx)(o.Z,{span:8,children:(0,I.jsx)(c.Z,{title:H("delivery.time"),children:(0,I.jsxs)(d.Z,{gutter:12,children:[(0,I.jsx)(o.Z,{span:12,children:(0,I.jsx)(l.Z.Item,{name:"delivery_time_type",label:H("delivery_time_type"),rules:[{required:!0,message:H("required")}],children:(0,I.jsxs)(x.Z,{className:"w-100",children:[(0,I.jsx)(x.Z.Option,{value:"minute",label:H("minutes")}),(0,I.jsx)(x.Z.Option,{value:"hour",label:H("hour")})]})})}),(0,I.jsx)(o.Z,{span:12,children:(0,I.jsx)(l.Z.Item,{name:"delivery_time_from",label:H("delivery_time_from"),rules:[{required:!0,message:H("required")}],children:(0,I.jsx)(g.Z,{className:"w-100"})})}),(0,I.jsx)(o.Z,{span:12,children:(0,I.jsx)(l.Z.Item,{name:"delivery_time_to",label:H("delivery_time_to"),rules:[{required:!0,message:H("required")}],children:(0,I.jsx)(g.Z,{className:"w-100"})})})]})})}),(0,I.jsx)(o.Z,{span:8,children:(0,I.jsx)(c.Z,{title:H("order.info"),children:(0,I.jsxs)(d.Z,{gutter:12,children:[(0,I.jsx)(o.Z,{span:12,children:(0,I.jsx)(l.Z.Item,{label:H("min.amount"),name:"min_amount",rules:[{required:!0,message:H("required")}],children:(0,I.jsx)(g.Z,{min:0,className:"w-100"})})}),(0,I.jsx)(o.Z,{span:12,children:(0,I.jsx)(l.Z.Item,{label:H("tax"),name:"tax",rules:[{required:!0,message:H("required")}],children:(0,I.jsx)(g.Z,{min:0,addonAfter:"%",className:"w-100"})})}),(0,I.jsx)(o.Z,{span:12,children:(0,I.jsx)(l.Z.Item,{label:H("admin.comission"),name:"percentage",rules:[{required:!0,message:H("required")}],children:(0,I.jsx)(g.Z,{min:0,className:"w-100",addonAfter:"%"})})})]})})}),(0,I.jsx)(o.Z,{span:24,children:(0,I.jsx)(c.Z,{title:H("address"),children:(0,I.jsxs)(d.Z,{gutter:12,children:[(0,I.jsx)(o.Z,{span:12,children:V.map(((e,t)=>(0,I.jsx)(q,{setLocation:$,form:b,item:e,idx:t,defaultLang:C},t)))}),(0,I.jsx)(o.Z,{span:24,children:(0,I.jsx)(y.Z,{location:_,setLocation:$,setAddress:e=>b.setFieldsValue({[`address[${C}]`]:e})})})]})})}),M&&(0,I.jsx)(S.Z,{visible:M,handleCancel:()=>T()}),D&&(0,I.jsx)(F.Z,{visible:D,handleCancel:()=>T()})]})};var O=s(48030),H=s(4577),M=s(51720);const Y=e=>{var t,s,d,o,c,u,m,g,h;let{next:x,action_type:Z="",user:p}=e;const{t:f}=(0,v.$)(),[y]=l.Z.useForm(),b=(0,r.s0)(),_=(0,j.I0)(),{uuid:q}=(0,r.UO)(),{activeMenu:w}=(0,j.v9)((e=>e.menu),j.wU),[k,S]=(0,a.useState)(!1),[F,L]=(0,a.useState)(null!==(t=w.data)&&void 0!==t&&t.logo_img?[null===(s=w.data)||void 0===s?void 0:s.logo_img]:[]),[N,Y]=(0,a.useState)(null!==(d=w.data)&&void 0!==d&&d.background_img?[null===(o=w.data)||void 0===o?void 0:o.background_img]:[]),{settings:D}=(0,j.v9)((e=>e.globalSettings),j.wU),[U,A]=(0,a.useState)(null!==w&&void 0!==w&&null!==(c=w.data)&&void 0!==c&&c.location?{lat:parseFloat(null===w||void 0===w||null===(u=w.data)||void 0===u||null===(m=u.location)||void 0===m?void 0:m.latitude),lng:parseFloat(null===w||void 0===w||null===(g=w.data)||void 0===g||null===(h=g.location)||void 0===h?void 0:h.longitude)}:(0,M.Z)(D));(0,a.useEffect)((()=>()=>{const e=y.getFieldsValue(!0);e.open_time=JSON.stringify(null===e||void 0===e?void 0:e.open_time),e.close_time=JSON.stringify(null===e||void 0===e?void 0:e.close_time),_((0,O.nc)({activeMenu:w,data:{...w.data,...e}}))}),[]);return(0,I.jsx)(I.Fragment,{children:(0,I.jsxs)(l.Z,{form:y,name:"basic",layout:"vertical",onFinish:e=>{var t,s,a;S(!0);const l={...e,"images[0]":null===(t=F[0])||void 0===t?void 0:t.name,"images[1]":null===(s=N[0])||void 0===s?void 0:s.name,delivery_time_type:e.delivery_time_type,delivery_time_to:e.delivery_time_to,delivery_time_from:e.delivery_time_from,categories:e.categories.map((e=>e.value)),tags:null===e||void 0===e||null===(a=e.tags)||void 0===a?void 0:a.map((e=>e.value)),user_id:e.user.value,open:void 0,"location[latitude]":U.lat,"location[longitude]":U.lng,user:void 0,delivery_time:0,type:"restaurant"};"edit"===Z?function(e,t){H.Z.update(q,t).then((()=>{_((0,O.nc)({activeMenu:w,data:e})),x()})).catch((e=>console.error(e))).finally((()=>S(!1)))}(e,l):function(e,t){H.Z.create(t).then((t=>{let{data:s}=t;_((0,O.SS)({id:`restaurant-${s.uuid}`,url:`restaurant/${s.uuid}`,name:f("add.restaurant"),data:{...s,background_img:{name:null===s||void 0===s?void 0:s.background_img},logo_img:{name:null===s||void 0===s?void 0:s.logo_img},...e},refetch:!1})),b(`/restaurant/${s.uuid}?step=1`)})).catch((e=>console.error(e))).finally((()=>S(!1)))}(e,l)},initialValues:{open:!1,status:"new",...w.data},children:[(0,I.jsx)($,{logoImage:F,setLogoImage:L,backImage:N,setBackImage:Y,form:y,location:U,setLocation:A,user:p}),(0,I.jsx)(n.Z,{children:(0,I.jsx)(i.Z,{type:"primary",htmlType:"submit",loading:k,children:f("next")})})]})})}},70049:(e,t,s)=>{s.r(t),s.d(t,{default:()=>x,steps:()=>h});var a=s(72791),l=s(79337),n=s(87320),i=s(33168),r=s(9109),d=s(54080),o=s(93669),c=s(34295),u=s(7560),m=s(80184);const{Step:g}=r.Z,h=[{title:"restaurant",content:"First-content"},{title:"map",content:"Second-content"},{title:"delivery",content:"Third-content"}],x=()=>{var e;const{t:t}=(0,i.$)(),{activeMenu:s}=(0,l.v9)((e=>e.menu),l.wU),[x,Z]=(0,a.useState)((null===(e=s.data)||void 0===e?void 0:e.step)||0),p=()=>{Z(x+1)},j=()=>{Z(x-1)};return(0,m.jsxs)(d.Z,{title:t("add.restaurant"),extra:(0,m.jsx)(n.Z,{}),children:[(0,m.jsx)(r.Z,{current:x,children:h.map((e=>(0,m.jsx)(g,{title:t(e.title)},e.title)))}),(0,m.jsxs)("div",{className:"steps-content",children:["First-content"===h[x].content&&(0,m.jsx)(o.Z,{next:p,user:!1}),"Second-content"===h[x].content&&(0,m.jsx)(u.Z,{next:p,prev:j}),"Third-content"===h[x].content&&(0,m.jsx)(c.Z,{next:p,prev:j})]})]})}},34295:(e,t,s)=>{s.d(t,{Z:()=>h});var a=s(77483),l=s(72791),n=s(63446),i=s(72426),r=s.n(i),d=s(43507),o=s(56487),c=s(16871),u=s(10060),m=s(29656),g=s(80184);const h=e=>{let{next:t,prev:s}=e;const[i]=a.Z.useForm(),[h,x]=(0,l.useState)([]),[Z,p]=(0,l.useState)(new Array(7).fill(!1)),[j,v]=(0,l.useState)(!1),[f,y]=(0,l.useState)(!1),{uuid:b}=(0,c.UO)();return(0,l.useEffect)((()=>{i.setFieldsValue({working_days:u.P}),b&&(y(!0),o.Z.getById(b).then((e=>{x(e.data.closed_dates.filter((e=>e.day>r()(new Date).format("YYYY-MM-DD"))).map((e=>new Date(e.day))))})),d.Z.getById(b).then((e=>{p(0!==e.data.dates.length?e.data.dates.map((e=>e.disabled)):[]),0!==e.data.dates.length&&i.setFieldsValue({working_days:e.data.dates.map((e=>({title:e.day,from:r()(e.from,"HH:mm:ss"),to:r()(e.to,"HH:mm:ss"),disabled:Boolean(e.disabled)})))})})).finally((()=>y(!1))))}),[]),(0,g.jsx)(g.Fragment,{children:f?(0,g.jsx)(n.Z,{}):(0,g.jsx)(m.Z,{onFinish:e=>{v(!0);const s={dates:h?h.map((e=>r()(e).format("YYYY-MM-DD"))):void 0},a={dates:e.working_days.map((e=>({day:e.title,from:r()(e.from?e.from:"00").format("HH-mm"),to:r()(e.to?e.to:"00").format("HH-mm"),disabled:e.disabled})))};o.Z.update(b,s).then((()=>{t()})).finally((()=>v(!1))),0!==e.working_days.length&&d.Z.update(b,a).then((()=>{t()})).finally((()=>v(!1)))},prev:s,form:i,lines:Z,loadingBtn:j,days:h,setDays:x,setLines:p,weeks:u.P})})}}}]);
//# sourceMappingURL=49.390e9219.chunk.js.map