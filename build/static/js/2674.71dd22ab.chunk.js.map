{"version":3,"file":"static/js/2674.71dd22ab.chunk.js","mappings":"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","sources":["helpers/getLanguageFields.js","views/shop-categories/category-edit.js"],"sourcesContent":["export default function getLanguageFields(languages, data, fields = ['title']) {\n  if (!data?.translations) {\n    return {};\n  }\n  const { translations } = data;\n  const getTranslations = (item, field) => {\n    const findItem = translations?.find((el) => el?.locale === item?.locale);\n    if (findItem) {\n      return findItem;\n    } else {\n      return {\n        [field]: '',\n      };\n    }\n  };\n  const result = languages.flatMap((item) =>\n    fields.flatMap((field) => ({\n      [`${field}[${item?.locale}]`]: getTranslations(item, field)[field],\n    })),\n  );\n\n  return Object.assign({}, ...result);\n}\n","import React, { useState, useEffect } from 'react';\nimport { Card, Form, Spin } from 'antd';\nimport { toast } from 'react-toastify';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport LanguageList from 'components/language-list';\nimport { batch, shallowEqual, useDispatch, useSelector } from 'react-redux';\nimport { disableRefetch, removeFromMenu, setMenuData } from 'redux/slices/menu';\nimport categoryService from 'services/category';\nimport { IMG_URL } from 'configs/app-global';\nimport { fetchShopCategories } from 'redux/slices/shopCategory';\nimport { useTranslation } from 'react-i18next';\nimport getLanguageFields from 'helpers/getLanguageFields';\nimport getTranslationFields from 'helpers/getTranslationFields';\nimport ShopCategoryForm from './category-form';\n\nconst CategoryEdit = () => {\n  const { t } = useTranslation();\n  const navigate = useNavigate();\n\n  const dispatch = useDispatch();\n  const { activeMenu } = useSelector((state) => state.menu, shallowEqual);\n  const { params } = useSelector((state) => state.shopCategory, shallowEqual);\n  const [loading, setLoading] = useState(false);\n  const [form] = Form.useForm();\n  const [error, setError] = useState(null);\n  const { uuid } = useParams();\n  const { languages } = useSelector((state) => state.formLang, shallowEqual);\n\n  useEffect(() => {\n    return () => {\n      const data = form.getFieldsValue(true);\n      dispatch(setMenuData({ activeMenu, data }));\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const createImage = (name) => {\n    return {\n      name,\n      url: IMG_URL + name,\n    };\n  };\n\n  const getCategory = (alias) => {\n    setLoading(true);\n    categoryService\n      .getById(alias)\n      .then((res) => {\n        let category = res.data;\n\n        const body = {\n          ...getLanguageFields(languages, category, ['title', 'description']),\n          image: [createImage(category?.img)],\n          keywords: category?.keywords.split(','),\n          parent_id: {\n            label: category?.parent?.translation?.title,\n            value: category?.parent_id,\n            key: category?.parent_id,\n          },\n          input: category?.input ?? 32767,\n          active: !!category?.active\n        };\n        form.setFieldsValue(body);\n        dispatch(setMenuData({ activeMenu, data: body }));\n      })\n      .finally(() => {\n        setLoading(false);\n        dispatch(disableRefetch(activeMenu));\n      });\n  };\n\n  const handleSubmit = (values, image) => {\n    const body = {\n      title: getTranslationFields(languages, values),\n      description: getTranslationFields(languages, values, 'description'),\n      type: values.parent_id?.value ? 'sub_shop' : 'shop',\n      active: Number(values?.active),\n      keywords: values?.keywords?.join(','),\n      parent_id: values?.parent_id?.value,\n      images: image?.map((image) => image?.name),\n      input: values?.input,\n    };\n    const nextUrl = 'catalog/shop/categories';\n\n    return categoryService\n      .update(uuid, body)\n      .then(() => {\n        toast.success(t('successfully.updated'));\n        batch(() => {\n          dispatch(removeFromMenu({ ...activeMenu, nextUrl }));\n          dispatch(fetchShopCategories(params));\n        });\n        navigate(`/catalog/shop/categories`);\n      })\n      .catch((err) => setError(err.response.data.params));\n  };\n\n  useEffect(() => {\n    if (activeMenu.refetch) {\n      getCategory(uuid);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [activeMenu.refetch]);\n\n  return (\n    <Card title={t('edit.category')} extra={<LanguageList />}>\n      {!loading ? (\n        <ShopCategoryForm\n          form={form}\n          handleSubmit={handleSubmit}\n          error={error}\n        />\n      ) : (\n        <div className='d-flex justify-content-center align-items-center py-5'>\n          <Spin size='large' className='mt-5 pt-5' />\n        </div>\n      )}\n    </Card>\n  );\n};\nexport default CategoryEdit;\n"],"names":["getLanguageFields","languages","data","fields","arguments","length","undefined","translations","getTranslations","item","field","findItem","find","el","locale","result","flatMap","Object","assign","CategoryEdit","t","useTranslation","navigate","useNavigate","dispatch","useDispatch","activeMenu","useSelector","state","menu","shallowEqual","params","shopCategory","loading","setLoading","useState","form","Form","error","setError","uuid","useParams","formLang","useEffect","getFieldsValue","setMenuData","alias","refetch","categoryService","then","res","_category$parent","_category$parent$tran","_category$input","category","body","image","name","img","url","IMG_URL","keywords","split","parent_id","label","parent","translation","title","value","key","input","active","setFieldsValue","finally","disableRefetch","_jsx","Card","extra","LanguageList","children","className","Spin","size","ShopCategoryForm","handleSubmit","values","_values$parent_id","_values$keywords","_values$parent_id2","getTranslationFields","description","type","Number","join","images","map","toast","batch","removeFromMenu","nextUrl","fetchShopCategories","catch","err","response"],"sourceRoot":""}